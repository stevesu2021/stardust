import{d as e,r as a,p as l,c as t,b as s,i as u,o as c,e as n,f as i,g as o,a as d,H as f,t as v,l as r,h as _,F as m,j as y,y as p,s as g,J as h}from"./index-VE_HmMG4.js";import{a as b,_ as k}from"./_plugin-vue_export-helper.B_VXoL-J.js";import{u as x}from"./user.DucKNo_G.js";const C=k(e({__name:"devout-create",setup(e){const k=x(),C=a(""),j=a(null),w=a([]),I=a([]),V=a(!0),A=a(!1),P=a(!1),F=l(()=>C.value.trim().length>0&&I.value.length>0&&!A.value),H=l(()=>P.value?"æ­£åœ¨åˆ†ç±»...":A.value?"æ­£åœ¨æäº¤...":C.value.trim()?0===I.value.length?"è¯·é€‰æ‹©ç¥žèŒ":"æäº¤ç¥ˆç¥·":"è¯·è¾“å…¥ç¥ˆç¥·å†…å®¹"),J=l(()=>w.value.length>0&&I.value.length===w.value.length);async function N(){C.value.trim()?P.value||await async function(){if(P.value)return;P.value=!0;try{const e=await b.devoutPrayer.classify(C.value);j.value={id:e.categoryId,name:e.categoryName,deities:e.deities},w.value=e.deities,I.value=[...e.deities]}catch(e){console.error("åˆ†ç±»å¤±è´¥:",e),g({title:"AIåˆ†ç±»å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•",icon:"none"})}finally{P.value=!1}}():g({title:"è¯·å…ˆè¾“å…¥ç¥ˆç¥·å†…å®¹",icon:"none"})}function O(){J.value?I.value=[]:I.value=[...w.value]}async function T(){var e,a;if(F.value)if(null==(e=k.userInfo)?void 0:e.id){A.value=!0;try{await b.devoutPrayer.create({content:C.value.trim(),category:null==(a=j.value)?void 0:a.id,deities:I.value,isAnonymous:V.value}),g({title:"ç¥ˆç¥·æˆåŠŸ",icon:"success"}),setTimeout(()=>{h()},1500)}catch(l){g({title:l.message||"æäº¤å¤±è´¥",icon:"none"})}finally{A.value=!1}}else g({title:"è¯·å…ˆç™»å½•",icon:"none"})}return(e,a)=>{const l=i,g=u,h=f,b=p;return c(),t(g,{class:"container"},{default:s(()=>[n(g,{class:"header"},{default:s(()=>[n(l,{class:"title"},{default:s(()=>[o("è™”è¯šç¥ˆç¥·")]),_:1}),n(l,{class:"subtitle"},{default:s(()=>[o("å‘ç¥žçµè¡¨è¾¾ä½ çš„å¿ƒæ„¿")]),_:1})]),_:1}),n(g,{class:"form"},{default:s(()=>[n(g,{class:"form-section"},{default:s(()=>[n(l,{class:"section-title"},{default:s(()=>[o("ç¥ˆç¥·å†…å®¹")]),_:1}),n(h,{class:"content-input",modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=e=>C.value=e),placeholder:"è¯·è¾“å…¥ä½ çš„ç¥ˆç¥·å†…å®¹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¸®ä½ åˆ†ç±»...",maxlength:500,"show-confirm-bar":!1},null,8,["modelValue"]),n(g,{class:"input-footer"},{default:s(()=>[n(l,{class:"char-count"},{default:s(()=>[o(v(C.value.length)+"/500",1)]),_:1}),n(g,{class:r(["classify-btn",{loading:P.value}]),onClick:N},{default:s(()=>[n(l,{class:"classify-icon"},{default:s(()=>[o(v(P.value?"â³":"âœ“"),1)]),_:1}),n(l,{class:"classify-text"},{default:s(()=>[o(v(P.value?"åˆ†ç±»ä¸­...":"å®Œæˆåˆ†ç±»"),1)]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}),j.value?(c(),t(g,{key:0,class:"form-section"},{default:s(()=>[n(l,{class:"section-title"},{default:s(()=>[o("æ™ºèƒ½åˆ†ç±»")]),_:1}),n(g,{class:"category-result"},{default:s(()=>[n(l,{class:"category-icon"},{default:s(()=>[o("âœ¨")]),_:1}),n(l,{class:"category-name"},{default:s(()=>[o(v(j.value.name),1)]),_:1}),n(l,{class:"category-hint"},{default:s(()=>[o("å·²æ ¹æ®å†…å®¹è‡ªåŠ¨åˆ†ç±»")]),_:1})]),_:1})]),_:1})):d("",!0),w.value.length>0?(c(),t(g,{key:1,class:"form-section"},{default:s(()=>[n(g,{class:"section-header"},{default:s(()=>[n(l,{class:"section-title"},{default:s(()=>[o("é€‰æ‹©ç¥ˆæ„¿ç¥žèŒ")]),_:1}),n(g,{class:"select-all-btn",onClick:O},{default:s(()=>[n(l,{class:"select-all-text"},{default:s(()=>[o(v(J.value?"å–æ¶ˆå…¨é€‰":"å…¨é€‰"),1)]),_:1})]),_:1})]),_:1}),n(g,{class:"deities-list"},{default:s(()=>[(c(!0),_(m,null,y(w.value,(e,a)=>(c(),t(g,{class:r(["deity-item",{selected:I.value.includes(e)}]),key:a,onClick:a=>function(e){const a=I.value.indexOf(e);a>-1?I.value.splice(a,1):I.value.push(e)}(e)},{default:s(()=>[n(l,{class:"deity-icon"},{default:s(()=>[o(v(I.value.includes(e)?"âœ“":""),1)]),_:2},1024),n(l,{class:"deity-name"},{default:s(()=>[o(v(e),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1}),n(l,{class:"selection-hint"},{default:s(()=>[o("å·²é€‰æ‹© "+v(I.value.length)+" ä½ç¥žèŒ",1)]),_:1})]),_:1})):d("",!0),n(g,{class:"form-section"},{default:s(()=>[n(l,{class:"section-title"},{default:s(()=>[o("æ˜¾ç¤ºè®¾ç½®")]),_:1}),n(g,{class:"anonymous-options"},{default:s(()=>[n(g,{class:r(["option-item",{active:V.value}]),onClick:a[1]||(a[1]=e=>V.value=!0)},{default:s(()=>[n(l,{class:"option-icon"},{default:s(()=>[o(v(V.value?"ðŸ”’":"ðŸ”“"),1)]),_:1}),n(g,{class:"option-content"},{default:s(()=>[n(l,{class:"option-title"},{default:s(()=>[o("åŒ¿åç¥ˆç¥·")]),_:1}),n(l,{class:"option-desc"},{default:s(()=>[o("åªæ˜¾ç¤ºåŒ¿åæ˜µç§°")]),_:1})]),_:1})]),_:1},8,["class"]),n(g,{class:r(["option-item",{active:!V.value}]),onClick:a[2]||(a[2]=e=>V.value=!1)},{default:s(()=>[n(l,{class:"option-icon"},{default:s(()=>[o(v(V.value?"ðŸ‘ï¸":"ðŸ‘¤"),1)]),_:1}),n(g,{class:"option-content"},{default:s(()=>[n(l,{class:"option-title"},{default:s(()=>[o("å®žåç¥ˆç¥·")]),_:1}),n(l,{class:"option-desc"},{default:s(()=>[o("æ˜¾ç¤ºæ‚¨çš„æ˜µç§°")]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}),n(b,{class:"submit-btn",onClick:T,loading:A.value,disabled:!F.value},{default:s(()=>[o(v(H.value),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-b95bd953"]]);export{C as default};
