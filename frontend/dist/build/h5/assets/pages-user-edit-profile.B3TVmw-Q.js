import{d as e,r as a,q as l,c as t,b as u,i as s,o as n,e as o,f as i,g as r,I as c,y as d,H as f,A as v,B as m,C as h,D as _,t as p,s as b,J as g}from"./index-VE_HmMG4.js";import{a as k,_ as y}from"./_plugin-vue_export-helper.B_VXoL-J.js";import{u as I}from"./user.DucKNo_G.js";const C=y(e({__name:"edit-profile",setup(e){const y=I(),C=a(""),V=a(""),x=a(""),D=a("male"),H=a(""),M=a(0),P=a(0),U=a(0),w=a(null),S=a(null),Y=a(""),j=a(""),$=a(!1),A=["å–ç«ç®­çš„å°éŸ­èœ","éª‘å…±äº«å•è½¦çš„æ‚Ÿç©º","åœ¨é€ƒè¿ªå£«å°¼åœ¨ç¼–å…¬ä¸»","ä¼šå†™ä»£ç çš„ç…é¥¼æœå­","æ‹¿é€€ä¼‘é‡‘çš„èµ›åšæœ‹å…‹","è¢«AIç‚’é±¿é±¼çš„è€æ¿","ç”¨Excelç®—å‘½çš„å¤§å¸ˆ","å·WiFiçš„é”¦é²¤æœ¬é²¤","ç†¬å¤œå† å†›ä½†èµ·ä¸æ¥åºŠ","å…ƒå®‡å®™ç§èœè€å†œæ°‘","èŠ±æœå±±é©»äº¬åŠä¸»ä»»","äº”æŒ‡å±±ä¸‹é€å¤–å–çš„çŒ´","ä¼šè·³å¹¿åœºèˆçš„åŒ—æç†Š","çˆ±å‘æœ‹å‹åœˆçš„æ ‘æ‡’","æ‹¥æœ‰æˆ¿è´·çš„æµæµªçŒ«","æƒ³è€ƒç¼–åˆ¶çš„å’¸é±¼","åœ¨CBDé›å¼¯çš„åœŸæ‹¨é¼ ","æ³¡é¢åŠ è›‹å°±æ˜¯æ»¡æ±‰å…¨å¸­","å·¥èµ„æœˆå…‰ä½†æ¢¦æƒ³å¾ˆäº®","ä¸€è¾¹èººå¹³ä¸€è¾¹ç„¦è™‘","æƒ³è¾èŒä½†ä¸æ•¢ç‚¹å‘é€","åƒåœŸä¹Ÿè¦ä¹°ç›²ç›’çš„äºº","æŠŠæ¢¦æƒ³å­˜è¿›ä½™é¢å®","ç”¨è¡¨æƒ…åŒ…è°ˆæ‹çˆ±çš„ç¤¾æ","åœ°çƒè§‚å¯Ÿå‘˜007å·","é“¶æ²³ç³»æ‘¸é±¼ç‰¹æ´¾å‘˜","å®‡å®™å’Œå¹³é¸½ï¼ˆä½†ä¼šéª‚äººï¼‰","å¹³è¡Œå®‡å®™çš„æˆ‘æ­£åœ¨æš´å¯Œ","æ—¶é—´ç®¡ç†å¤±è´¥å¤§å¸ˆ","å¿«ä¹åºŸæŸ´è”ç›Ÿä¼šé•¿"];function B(){const e=Math.floor(Math.random()*A.length);V.value=A[e]}const N=["å­æ—¶ (23:00-01:00)","ä¸‘æ—¶ (01:00-03:00)","å¯…æ—¶ (03:00-05:00)","å¯æ—¶ (05:00-07:00)","è¾°æ—¶ (07:00-09:00)","å·³æ—¶ (09:00-11:00)","åˆæ—¶ (11:00-13:00)","æœªæ—¶ (13:00-15:00)","ç”³æ—¶ (15:00-17:00)","é…‰æ—¶ (17:00-19:00)","æˆŒæ—¶ (19:00-21:00)","äº¥æ—¶ (21:00-23:00)"],q=["åŒ—äº¬","å¤©æ´¥","ä¸Šæµ·","é‡åº†","æ²³åŒ—","å±±è¥¿","è¾½å®","å‰æ—","é»‘é¾™æ±Ÿ","æ±Ÿè‹","æµ™æ±Ÿ","å®‰å¾½","ç¦å»º","æ±Ÿè¥¿","å±±ä¸œ","æ²³å—","æ¹–åŒ—","æ¹–å—","å¹¿ä¸œ","æµ·å—","å››å·","è´µå·","äº‘å—","é™•è¥¿","ç”˜è‚ƒ","é’æµ·","å°æ¹¾","å†…è’™å¤","å¹¿è¥¿","è¥¿è—","å®å¤","æ–°ç–†","é¦™æ¸¯","æ¾³é—¨"];function E(e){D.value=e.detail.value}function F(e){H.value=e.detail.value;const[a,l,t]=e.detail.value.split("-");M.value=parseInt(a),P.value=parseInt(l),U.value=parseInt(t)}function J(e){S.value=e.detail.value;w.value=[23,1,3,5,7,9,11,13,15,17,19,21][e.detail.value]}function O(e){Y.value=q[e.detail.value]}function T(e){j.value=q[e.detail.value]}async function W(){if(C.value&&C.value.trim())if(H.value)if(null!==w.value)if(Y.value)if(j.value){$.value=!0;try{const a={nickname:C.value.trim(),anonymousNickname:V.value.trim(),bio:x.value.trim(),gender:D.value,birthYear:M.value,birthMonth:P.value,birthDay:U.value,birthHour:w.value,birthProvince:Y.value,currentProvince:j.value},l=await k.user.update(y.userInfo.id,a);y.setUserInfo(l);try{const e=await k.astrology.calculate(y.userInfo.id),a=await k.auth.getProfile();y.setUserInfo(a.user),console.log("æ˜Ÿç›˜è®¡ç®—æˆåŠŸ:",e)}catch(e){console.error("æ˜Ÿç›˜è®¡ç®—å¤±è´¥:",e)}b({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),setTimeout(()=>{g()},1500)}catch(a){let e="ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";a.message?e=a.message:a.data&&a.data.message&&(e=a.data.message),b({title:e,icon:"none",duration:3e3})}finally{$.value=!1}}else b({title:"è¯·é€‰æ‹©ç°å±…åœ°çœä»½",icon:"none"});else b({title:"è¯·é€‰æ‹©å‡ºç”Ÿçœä»½",icon:"none"});else b({title:"è¯·é€‰æ‹©å‡ºç”Ÿæ—¶è¾°",icon:"none"});else b({title:"è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ",icon:"none"});else b({title:"è¯·è¾“å…¥æ˜µç§°",icon:"none"})}return l(()=>{if(y.userInfo){const e=y.userInfo;if(C.value=e.nickname||"",V.value=e.anonymousNickname||"",x.value=e.bio||"",D.value=e.gender||"male",e.birthYear&&e.birthMonth&&e.birthDay&&(M.value=e.birthYear,P.value=e.birthMonth,U.value=e.birthDay,H.value=`${e.birthYear}-${String(e.birthMonth).padStart(2,"0")}-${String(e.birthDay).padStart(2,"0")}`),void 0!==e.birthHour&&null!==e.birthHour){w.value=e.birthHour;const a=[23,1,3,5,7,9,11,13,15,17,19,21].indexOf(e.birthHour);-1!==a&&(S.value=a)}Y.value=e.birthProvince||"",j.value=e.currentProvince||"åŒ—äº¬"}}),(e,a)=>{const l=i,b=c,g=s,k=d,y=f,I=h,M=m,P=v,U=_;return n(),t(g,{class:"container"},{default:u(()=>[o(g,{class:"form"},{default:u(()=>[o(g,{class:"form-item"},{default:u(()=>[o(l,{class:"label"},{default:u(()=>[r("æ˜µç§°")]),_:1}),o(b,{class:"input",modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=e=>C.value=e),placeholder:"è¯·è¾“å…¥æ˜µç§°"},null,8,["modelValue"])]),_:1}),o(g,{class:"form-item"},{default:u(()=>[o(l,{class:"label"},{default:u(()=>[r("åŒ¿åæ˜µç§°")]),_:1}),o(g,{class:"anonymous-input-wrapper"},{default:u(()=>[o(b,{class:"input anonymous-input",modelValue:V.value,"onUpdate:modelValue":a[1]||(a[1]=e=>V.value=e),placeholder:"ç”¨äºæ ‘æ´ç­‰åœºæ™¯"},null,8,["modelValue"]),o(k,{class:"refresh-btn",onClick:B},{default:u(()=>[r("ğŸ²")]),_:1})]),_:1}),o(l,{class:"hint"},{default:u(()=>[r("ç‚¹å‡»ğŸ²å¯ä»¥éšæœºæ›´æ¢æ˜µç§°")]),_:1})]),_:1}),o(g,{class:"form-item"},{default:u(()=>[o(l,{class:"label"},{default:u(()=>[r("ä¸ªäººç®€ä»‹")]),_:1}),o(y,{class:"textarea",modelValue:x.value,"onUpdate:modelValue":a[2]||(a[2]=e=>x.value=e),placeholder:"ä»‹ç»ä¸€ä¸‹è‡ªå·±"},null,8,["modelValue"])]),_:1}),o(g,{class:"form-item"},{default:u(()=>[o(l,{class:"label"},{default:u(()=>[r("æ€§åˆ«")]),_:1}),o(P,{onChange:E},{default:u(()=>[o(M,{class:"radio"},{default:u(()=>[o(I,{value:"male",checked:"male"===D.value},null,8,["checked"]),o(l,null,{default:u(()=>[r("ç”·")]),_:1})]),_:1}),o(M,{class:"radio"},{default:u(()=>[o(I,{value:"female",checked:"female"===D.value},null,8,["checked"]),o(l,null,{default:u(()=>[r("å¥³")]),_:1})]),_:1})]),_:1})]),_:1}),o(g,{class:"form-item"},{default:u(()=>[o(l,{class:"label"},{default:u(()=>[r("å‡ºç”Ÿæ—¥æœŸ")]),_:1}),o(U,{mode:"date",value:H.value||"1996-01-01",onChange:F},{default:u(()=>[o(g,{class:"picker"},{default:u(()=>[r(p(H.value||"è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ"),1)]),_:1})]),_:1},8,["value"])]),_:1}),o(g,{class:"form-item"},{default:u(()=>[o(l,{class:"label"},{default:u(()=>[r("å‡ºç”Ÿæ—¶è¾°")]),_:1}),o(U,{mode:"selector",range:N,onChange:J},{default:u(()=>[o(g,{class:"picker"},{default:u(()=>[r(p(null!==S.value?N[S.value]:"è¯·é€‰æ‹©å‡ºç”Ÿæ—¶è¾°"),1)]),_:1})]),_:1})]),_:1}),o(g,{class:"form-item"},{default:u(()=>[o(l,{class:"label"},{default:u(()=>[r("å‡ºç”Ÿçœä»½")]),_:1}),o(U,{mode:"selector",range:q,onChange:O},{default:u(()=>[o(g,{class:"picker"},{default:u(()=>[r(p(Y.value||"è¯·é€‰æ‹©å‡ºç”Ÿçœä»½"),1)]),_:1})]),_:1})]),_:1}),o(g,{class:"form-item"},{default:u(()=>[o(l,{class:"label"},{default:u(()=>[r("ç°å±…åœ°çœä»½")]),_:1}),o(U,{mode:"selector",range:q,onChange:T},{default:u(()=>[o(g,{class:"picker"},{default:u(()=>[r(p(j.value||"è¯·é€‰æ‹©ç°å±…åœ°çœä»½"),1)]),_:1})]),_:1})]),_:1}),o(k,{class:"btn",onClick:W,loading:$.value},{default:u(()=>[r("ä¿å­˜ä¿®æ”¹")]),_:1},8,["loading"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-3c735198"]]);export{C as default};
