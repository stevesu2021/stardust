import{d as a,r as e,p as l,q as t,s,c as u,b as c,i as n,o as i,e as o,a as v,f as d,g as r,n as f,t as _,l as p,y as b,X as h}from"./index-VE_HmMG4.js";import{a as g,_ as m}from"./_plugin-vue_export-helper.B_VXoL-J.js";const y=m(a({__name:"test",setup(a){const m=e([]),y=e([]),x=e(0),w=e(!1),k=l(()=>(x.value+1)/m.value.length*100),q=l(()=>m.value[x.value]);function C(a){y.value[x.value]=a}function j(){x.value>0&&x.value--}async function I(){y.value[x.value]?x.value<m.value.length-1?x.value++:await async function(){if(w.value)return;w.value=!0;try{const a=y.value.filter(a=>a);await g.mbti.submit(a),s({title:"测试完成",icon:"success"}),setTimeout(()=>{h({url:"/pages/mbti/result"})},1500)}catch(a){s({title:a.message||"提交失败",icon:"none"})}finally{w.value=!1}}():s({title:"请先选择一个选项",icon:"none"})}return t(async()=>{await async function(){try{const a=await g.mbti.getQuestions();m.value=a,y.value=new Array(a.length).fill("")}catch(a){s({title:"加载题目失败",icon:"none"})}}()}),(a,e)=>{const l=d,t=n,s=b;return i(),u(t,{class:"test-page"},{default:c(()=>[o(t,{class:"header"},{default:c(()=>[o(l,{class:"title"},{default:c(()=>[r("MBTI 人格测试")]),_:1}),o(l,{class:"subtitle"},{default:c(()=>[r("发现你的真实性格类型")]),_:1})]),_:1}),o(t,{class:"progress-bar"},{default:c(()=>[o(t,{class:"progress-fill",style:f({width:k.value+"%"})},null,8,["style"])]),_:1}),o(l,{class:"progress-text"},{default:c(()=>[r(_(x.value+1)+" / "+_(m.value.length),1)]),_:1}),q.value?(i(),u(t,{key:0,class:"question-card"},{default:c(()=>[o(l,{class:"question-text"},{default:c(()=>[r(_(q.value.question),1)]),_:1}),o(t,{class:"options"},{default:c(()=>[o(t,{class:p(["option-item",{selected:y.value[x.value]===q.value.choice_a.value}]),onClick:e[0]||(e[0]=a=>C(q.value.choice_a.value))},{default:c(()=>[o(l,{class:"option-text"},{default:c(()=>[r(_(q.value.choice_a.text),1)]),_:1})]),_:1},8,["class"]),o(t,{class:p(["option-item",{selected:y.value[x.value]===q.value.choice_b.value}]),onClick:e[1]||(e[1]=a=>C(q.value.choice_b.value))},{default:c(()=>[o(l,{class:"option-text"},{default:c(()=>[r(_(q.value.choice_b.text),1)]),_:1})]),_:1},8,["class"])]),_:1})]),_:1})):v("",!0),o(t,{class:"actions"},{default:c(()=>[o(s,{class:"btn btn-secondary",onClick:j,disabled:0===x.value},{default:c(()=>[r(" 上一题 ")]),_:1},8,["disabled"]),o(s,{class:"btn btn-primary",onClick:I,disabled:!y.value[x.value]},{default:c(()=>[r(_(x.value===m.value.length-1?"提交":"下一题"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-0d633f20"]]);export{y as default};
